<?xml version="1.0" encoding="utf-8"?>
<odoo>
<!-- Payments -->
  <record id="cheque_create_view" model="ir.ui.view">
    <field name="name">cheque_create_view</field>
    <field name="model">account.payment</field>
    <field name="arch" type="xml">
      <form string="Receive Cheque">
          <header>
              <button name="post" class="oe_highlight" states="draft" string="Confirm" type="object"/>
              <field name="state" widget="statusbar" statusbar_visible="posted,reconciled"/>
          </header>
          <sheet>
            <!-- <div>
            <h1 attrs="{'invisible': [('payment_type', '!=', 'inbound')]}">Receive Cheque</h1>
            <h1 attrs="{'invisible': [('payment_type', '!=', 'outbound')]}">Send Cheque</h1>
          </div> -->
              <div class="oe_title" attrs="{'invisible': [('state', '=', 'draft')]}">
                  <h1><field name="name"/></h1>
              </div>
              <group>
                  <group>
                    <field name="id" invisible="1"/>
                      <field name="payment_type" invisible="1"
                        attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                      <field name="partner_type" invisible="1"
                        attrs="{'required': [('payment_type', 'in', ('inbound', 'outbound'))],
                        'invisible': [('payment_type', 'not in', ('inbound', 'outbound'))],
                        'readonly': [('state', '!=', 'draft')]}"/>
                      <field name="partner_id"
                        attrs="{'required': [('payment_type', 'in', ('inbound', 'outbound'))],
                        'invisible': [('payment_type', 'not in', ('inbound', 'outbound'))],
                        'readonly': [('state', '!=', 'draft')]}"
                        context="{'default_is_company': True,
                        'default_supplier': payment_type == 'outbound',
                        'default_customer': payment_type == 'inbound'}"/>
                      <field name="cheque_journal_id"
                        domain="[('type', 'in', journal_type),
                        ('jrnl_is_cheque','in',journal_cheque_val)]"
                        widget="selection" string="Journal" required="1"
                        attrs="{'readonly': [('state', '!=', 'draft')],}"/>
                        <field name="journal_id" invisible="1"/>
                      <field name="destination_journal_id" invisible="1"/>
                      <field name="hide_payment_method" invisible="1"/>
                      <field name="is_cheque" invisible="1"/>
                      <field name="payment_method_id" widget="radio"
                        attrs="{'invisible': [('hide_payment_method', '=', True)],
                        'readonly': [('state', '!=', 'draft')]}"/>
                      <field name="payment_method_code" invisible="1"/>
                      <label for="amount"/>
                      <div name="amount_div" class="o_row">
                          <field name="amount" string="Cheque Amount"
                            attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                          <field name="currency_id"
                            attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                      </div>
                  </group>
                  <group>
                      <field name="payment_date" string="Cheque Date"
                        attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                      <field name="communication" string="Cheque No."
                        attrs="{'invisible': [('state', '!=', 'draft'),
                        ('communication', '=', False)],
                        'readonly': [('state', '!=', 'draft')],
                        'required': [('is_cheque', '=', True)],}"/>
                  </group>
              </group>
          </sheet>
      </form>
    </field>
  </record>

  <record id="cheque_receive_action" model="ir.actions.act_window">
    <field name="name">Receive Cheques</field>
    <field name="display_name">Receive Cheques</field>
    <field name="view_id" ref="cheque_create_view"/>
    <!-- <field name="view_ids" eval="[(5, 0, 0),
      (0, 0, {'view_mode': 'tree', 'view_id': ref('account.view_account_payment_tree')}),
      (0, 0, {'view_mode': 'form', 'view_id': ref('cheque_create_view')})]"/> -->
    <field name="res_model">account.payment</field>
    <field name="view_mode">tree,form</field>
    <field name="context">{'default_is_cheque':1,
      'default_payment_type':'inbound',
      'journal_type':['general','cash'],
      'journal_cheque_val':[1],}</field>
    <!-- <field name="domain">[('is_cheque', '=', True),
      ('payment_type','=','inbound'),]</field> -->
    <field name="help" type="html">
      <p class="oe_view_nocontent_create">
      </p>
    </field>
  </record>

  <record id="cheque_send_action" model="ir.actions.act_window">
    <field name="name">Send Cheques</field>
    <field name="view_id" ref="cheque_create_view"/>
    <!-- <field name="view_ids" eval="[(5, 0, 0),
      (0, 0, {'view_mode': 'tree', 'view_id': ref('account.view_account_payment_tree')}),
      (0, 0, {'view_mode': 'form', 'view_id': ref('cheque_create_view')})]"/> -->
    <field name="res_model">account.payment</field>
    <field name="view_mode">tree,form</field>
    <field name="context">{'default_is_cheque':1,
      'default_payment_type':'outbound',
      'journal_type':['bank'],
      'journal_cheque_val':[1],}</field>
    <!-- <field name="domain">[('is_cheque', '=', True),
      ('payment_type','=','outbound'),]</field> -->
    <field name="help" type="html">
      <p class="oe_view_nocontent_create">
      </p>
    </field>
  </record>

  <menuitem id="menu_cheques" name="Cheques Management" parent="account.menu_finance" sequence="3"/>
    <menuitem id="menu_cheques_register" name="Register Cheques" parent="menu_cheques" sequence="1"/>
    <menuitem id="menu_cheque_receive_action" action="cheque_receive_action"
    name="Receive Cheques" parent="menu_cheques_register" sequence="1"/>
    <menuitem id="menu_cheque_send_action" action="cheque_send_action"
      name="Send Cheques" parent="menu_cheques_register" sequence="2"/>

<!-- Account move lines -->

  <record id="cheque_view_tree" model="ir.ui.view">
    <field name="name">cheque_view_tree</field>
    <field name="model">account.move.line</field>
    <field name="arch" type="xml">
      <tree string="Cheques" create="0" edit="1" delete="0" editable="inline">
        <field name="ref" string="Cheque No." attrs="{'readonly': [('ref','=',True)]}"/>
        <field name="date" readonly="1"/>
        <field name="move_id" invisible="1"/>
        <field name="journal_id" readonly="1" options="{&quot;no_open&quot;:True}"/>
        <field name="name" invisible="1"/>
        <field name="statement_id" invisible="1"/>
        <field name="partner_id" readonly="1"/>
        <field name="account_id" readonly="1" string="Status" domain="[('company_id', '=', company_id)]"/>
        <field name="analytic_account_id" invisible="1"/>
        <field name="reconciled" invisible="1"/>
        <field name="full_reconcile_id" invisible="1"/>
        <field name="debit" invisible="1"/>
        <field name="credit" invisible="1"/>
        <field name="balance" string="Amount" readonly="1"/>
        <field name="amount_currency" readonly="True" groups="base.group_multi_currency"/>
        <field name="currency_id" readonly="True" groups="base.group_multi_currency"/>
        <field name="date_maturity" invisible="1"/>
        <field name="company_currency_id" invisible="1"/>
        <field name="company_id" invisible="1"/>
      </tree>
    </field>
  </record>

  <record id="cheque_sent_list_action" model="ir.actions.act_window">
    <field name="name">Cheques sent</field>
    <!-- <field name="view_id" ref="cheque_view_tree"/> -->
    <field name="view_ids" eval="[(5, 0, 0),
      (0, 0, {'view_mode': 'tree', 'view_id': ref('cheque_view_tree')}),
      (0, 0, {'view_mode': 'form', 'view_id': ref('account.view_move_line_form')})]"/>
    <field name="res_model">account.move.line</field>
    <field name="view_mode">tree</field>
    <field name="context">{}</field>
    <field name="domain">[('aml_is_cheque', '=', True),
      ('account_id.reconcile','=',1),
      ('reconciled','=',False),('debit','&gt;',0.0),
      ('journal_id.type','=','bank')]</field>
    <field name="help" type="html">
      <p class="oe_view_nocontent_create">
      </p>
    </field>
  </record>

  <record id="cheque_received_list_action" model="ir.actions.act_window">
    <field name="name">Cheques received</field>
    <!-- <field name="view_id" ref="cheque_view_tree"/> -->
    <field name="view_ids" eval="[(5, 0, 0),
      (0, 0, {'view_mode': 'tree', 'view_id': ref('cheque_view_tree')}),
      (0, 0, {'view_mode': 'form', 'view_id': ref('account.view_move_line_form')})]"/>
    <field name="res_model">account.move.line</field>
    <field name="view_mode">tree</field>
    <field name="context">{}</field>
    <field name="domain">[('aml_is_cheque', '=', True),
      ('reconciled','=',False),('debit','&gt;',0.0),
      ('journal_id.type','in',['cash','general'])]</field>
    <field name="help" type="html">
      <p class="oe_view_nocontent_create">
      </p>
    </field>
  </record>

  <menuitem id="menu_cheques_history" name="Cheques history" parent="menu_cheques" sequence="2"/>
    <menuitem id="menu_cheque_received_action" action="cheque_received_list_action"
    name="Cheques received" parent="menu_cheques_history" sequence="1"/>
    <menuitem id="menu_cheque_sent_action" action="cheque_sent_list_action"
    name="Cheques sent" parent="menu_cheques_history" sequence="2"/>

<!-- Acoount Journal -->
  <record id="journal_form" model="ir.ui.view">
    <field name="name">journal_form</field>
    <field name="model">account.journal</field>
    <field name="inherit_id" ref="account.view_account_journal_form"/>
    <field name="arch" type="xml">
      <field name="type" position="after">
        <field name="jrnl_is_cheque" />
      </field>
    </field>
  </record>

<!-- Reconcile wiz ToDo -
  <record id="view_cheque_reconcile_full" model="ir.ui.view">
    <field name="name">cheque.full.form</field>
    <field name="model">account.move.line.reconcile</field>
    <field name="arch" type="xml">
        <form string="Reconciliation">
            <group col="4" string="Reconciliation Transactions">
                <field name="trans_nbr"/>
                <newline/>
                <field name="debit"/>
                <field name="credit"/>
                <field name="company_id" invisible="1"/>
            </group><group string="Write-Off">
                <field name="writeoff"/>
            </group>
            <footer>
                <button string="Reconcile" name="trans_rec_reconcile_full" type="object" default_focus="1" attrs="{'invisible':[('writeoff','!=',0)]}" class="btn-primary"/>
                <button string="Reconcile With Write-Off" name="trans_rec_addendum_writeoff" type="object" attrs="{'invisible':[('writeoff','=',0)]}" class="btn-primary"/>
                <button string="Partial Reconcile" name="trans_rec_reconcile_partial_reconcile" type="object" attrs="{'invisible':['|',('writeoff','=',0),('trans_nbr','&lt;',2)]}" class="btn-primary"/>
                <button string="Cancel" class="btn-default" special="cancel"/>
            </footer>
       </form>
    </field>
  </record>

  <record id="action_view_cheque_reconcile" model="ir.actions.act_window">
      <field name="name">Reconcile Cheques</field>
      <field name="res_model">account.move.line.reconcile</field>
      <field name="view_type">form</field>
      <field name="view_mode">form</field>
      <field name="view_id" ref="view_cheque_reconcile_full"/>
      <field name="target">new</field>
  </record>

  <record model="ir.values" id="action_cheque_reconcile_prompt_values">
      <field name="model_id" ref="account.model_account_move_line" />
      <field name="name">Reconcile Cheques</field>
      <field name="key2">client_action_multi</field>
      <field name="value" eval="'ir.actions.act_window,' +str(ref('action_view_cheque_reconcile'))" />
      <field name="key">action</field>
      <field name="model">account.move.line</field>
  </record> -->

</odoo>
